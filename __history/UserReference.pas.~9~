unit UserReference;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Imaging.pngimage, Vcl.ExtCtrls,
  Vcl.Grids, Vcl.StdCtrls, Vcl.Mask, Vcl.DBCtrls;

type
  TFrUserReference = class(TForm)
    Panel1: TPanel;
    SGAddPipe: TStringGrid;
    Image1: TImage;
    Label1: TLabel;
    Label2: TLabel;
    DBIDuserRef: TDBEdit;
    Label3: TLabel;
    procedure FormCreate(Sender: TObject);
    procedure Label1Click(Sender: TObject);
    procedure Label3Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FrUserReference: TFrUserReference;

implementation

{$R *.dfm}

uses DataModule;

procedure TFrUserReference.FormCreate(Sender: TObject);
begin
  SGAddPipe.ColWidths[0]:=34;
  SGAddPipe.ColWidths[1]:=300;
  SGAddPipe.ColWidths[2]:=300;

  SGAddPipe.Cells[0,0]:='№';
  SGAddPipe.Cells[1,0]:='Наименование параметра';
  SGAddPipe.Cells[2,0]:='Значение';

  SGAddPipe.Cells[0,1]:='1';
  SGAddPipe.Cells[0,2]:='2';
  SGAddPipe.Cells[0,3]:='3';
  SGAddPipe.Cells[0,4]:='4';
  SGAddPipe.Cells[0,5]:='5';
  SGAddPipe.Cells[0,6]:='6';
  SGAddPipe.Cells[0,7]:='7';
  SGAddPipe.Cells[0,8]:='8';
  SGAddPipe.Cells[0,9]:='9';
  SGAddPipe.Cells[0,10]:='10';
  SGAddPipe.Cells[0,11]:='11';
  SGAddPipe.Cells[0,12]:='12';
  SGAddPipe.Cells[0,13]:='13';

  SGAddPipe.Cells[1,1]:='Наименование скважинного инструмента';
  SGAddPipe.Cells[1,2]:='Наружный диаметр, мм';
  SGAddPipe.Cells[1,3]:='Внутренний диаметр, мм';
  SGAddPipe.Cells[1,4]:='Максимальный диаметр, мм';
  SGAddPipe.Cells[1,5]:='Диаметр муфты наружный, мм';
  SGAddPipe.Cells[1,6]:='Диаметр муфты внутренний, мм';
  SGAddPipe.Cells[1,7]:='Длина муфты, мм';
  SGAddPipe.Cells[1,8]:='Масса одного метра инструмента, кг';
  SGAddPipe.Cells[1,9]:='Масса муфты, кг';
  SGAddPipe.Cells[1,10]:='Масса двух высадок, кг';
  SGAddPipe.Cells[1,11]:='Длина секции, м';
  SGAddPipe.Cells[1,12]:='Длина элемента, м';
  SGAddPipe.Cells[1,13]:='Примечание';
end;

procedure TFrUserReference.Label1Click(Sender: TObject);
begin
  DataModule1.FDQinsert.ParamByName('Name').AsString:=SGAddPipe.Cells[2,1];
  DataModule1.FDQinsert.ParamByName('Dn').AsFloat:=StrToFloat(SGAddPipe.Cells[2,2]);
  DataModule1.FDQinsert.ParamByName('Dv').AsFloat:=StrToFloat(SGAddPipe.Cells[2,3]);
  DataModule1.FDQinsert.ParamByName('Dmax').AsFloat:=StrToFloat(SGAddPipe.Cells[2,4]);
  DataModule1.FDQinsert.ParamByName('Dmn').AsFloat:=StrToFloat(SGAddPipe.Cells[2,5]);
  DataModule1.FDQinsert.ParamByName('Dmv').AsFloat:=StrToFloat(SGAddPipe.Cells[2,6]);
  DataModule1.FDQinsert.ParamByName('Lm').AsFloat:=StrToFloat(SGAddPipe.Cells[2,7]);
  DataModule1.FDQinsert.ParamByName('Mi').AsFloat:=StrToFloat(SGAddPipe.Cells[2,8]);
  DataModule1.FDQinsert.ParamByName('Mm').AsFloat:=StrToFloat(SGAddPipe.Cells[2,9]);
  DataModule1.FDQinsert.ParamByName('M2v').AsFloat:=StrToFloat(SGAddPipe.Cells[2,10]);
  DataModule1.FDQinsert.ParamByName('Ls').AsFloat:=StrToFloat(SGAddPipe.Cells[2,11]);
  DataModule1.FDQinsert.ParamByName('Le').AsFloat:=StrToFloat(SGAddPipe.Cells[2,12]);
  DataModule1.FDQinsert.ParamByName('Comments').AsString:=SGAddPipe.Cells[2,13];

  DataModule1.FDQinsert.ExecSQL;
  ShowMessage('Запись добавлена');
  DataModule1.FDQUserRef.Refresh;
end;

procedure TFrUserReference.Label3Click(Sender: TObject);
begin
  DataModule1.FDQupdate.ParamByName('Name').AsString:=SGAddPipe.Cells[2,1];
  DataModule1.FDQupdate.ParamByName('Dn').AsFloat:=StrToFloat(SGAddPipe.Cells[2,2]);
  DataModule1.FDQupdate.ParamByName('Dv').AsFloat:=StrToFloat(SGAddPipe.Cells[2,3]);
  DataModule1.FDQupdate.ParamByName('Dmax').AsFloat:=StrToFloat(SGAddPipe.Cells[2,4]);
  DataModule1.FDQupdate.ParamByName('Dmn').AsFloat:=StrToFloat(SGAddPipe.Cells[2,5]);
  DataModule1.FDQupdate.ParamByName('Dmv').AsFloat:=StrToFloat(SGAddPipe.Cells[2,6]);
  DataModule1.FDQupdate.ParamByName('Lm').AsFloat:=StrToFloat(SGAddPipe.Cells[2,7]);
  DataModule1.FDQupdate.ParamByName('Mi').AsFloat:=StrToFloat(SGAddPipe.Cells[2,8]);
  DataModule1.FDQupdate.ParamByName('Mm').AsFloat:=StrToFloat(SGAddPipe.Cells[2,9]);
  DataModule1.FDQupdate.ParamByName('M2v').AsFloat:=StrToFloat(SGAddPipe.Cells[2,10]);
  DataModule1.FDQupdate.ParamByName('Ls').AsFloat:=StrToFloat(SGAddPipe.Cells[2,11]);
  DataModule1.FDQupdate.ParamByName('Le').AsFloat:=StrToFloat(SGAddPipe.Cells[2,12]);
  DataModule1.FDQupdate.ParamByName('Comments').AsString:=SGAddPipe.Cells[2,13];
  DataModule1.FDQupdate.ParamByName('ID').AsInteger:=StrToInt(DBIDuserRef);

  DataModule1.FDQupdate.ExecSQL;
  ShowMessage('Запись обнавлена');
  DataModule1.FDQUserRef.Refresh;
end;

end.
