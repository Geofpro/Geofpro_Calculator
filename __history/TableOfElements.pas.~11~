unit TableOfElements;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Grids, Vcl.StdCtrls, Vcl.ExtCtrls, ClassСonversionElements;

type
  TFTableOfElements = class(TForm)
    Panel1: TPanel;
    Label1: TLabel;
    SGElements: TStringGrid;
    Panel2: TPanel;
    Button1: TButton;
    procedure FormCreate(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  procedure СonversionElements;  // преобразование
  end;

var
  FTableOfElements: TFTableOfElements;
  ElementsNum: TConversionElements;

implementation

{$R *.dfm}

uses pipe_calculator;

// в этом модуле преобразуем секцию в элементы, например в секции длиной 120 метров
// содержится 10 труб (элементов) по 12 метров.

procedure TFTableOfElements.СonversionElements;
 var E7: String;
 var E1, E2, E3, E4, E5, E6 : Real;

begin
   ElementsNum:= TConversionElements.Create;
   E1:=StrToFloat(Fcalculator3i.StringGrid1.Cells[8,1]);
   E2:=StrToFloat(Fcalculator3i.StringGrid1.Cells[9,1]);
   E3:=StrToFloat(Fcalculator3i.StringGrid1.Cells[10,1]);
   E4:=StrToFloat(Fcalculator3i.StringGrid1.Cells[11,1]);
   E5:=StrToFloat(Fcalculator3i.StringGrid1.Cells[12,1]);
   E6:=StrToFloat(Fcalculator3i.StringGrid1.Cells[7,1]);
   E7:=Fcalculator3i.StringGrid1.Cells[1,1];
   ElementsNum.InputData (E1, E2, E3, E4, E5, E6, E7);
   ElementsNum.Elements9;
   ElementsNum.ExportElements;
end;

procedure TFTableOfElements.Button1Click(Sender: TObject);
begin
  СonversionElements;
end;

procedure TFTableOfElements.FormCreate(Sender: TObject);
begin
 // свойства таблицы StringGrid1
  SGElements.ColWidths[0] := 40;
  SGElements.ColWidths[1] := 200;
  SGElements.ColWidths[2] := 110;
  SGElements.ColWidths[3] := 110;
  SGElements.ColWidths[4] := 110;
  SGElements.ColWidths[5] := 110;
  SGElements.ColWidths[6] := 120;
  SGElements.ColWidths[7] := 120;
  SGElements.ColWidths[8] := 120;


  SGElements.Cells[0,0]:='№';
  SGElements.Cells[1,0]:='Наименование';
  SGElements.Cells[2,0]:='Длина м, мм';
  SGElements.Cells[3,0]:='Масса i,кг';
  SGElements.Cells[4,0]:='Масса м,кг';
  SGElements.Cells[5,0]:='Масса 2в,кг';
  SGElements.Cells[6,0]:='Длина элемента, м';
  SGElements.Cells[7,0]:='Масса, кг';
  SGElements.Cells[8,0]:='Вес, кН';

end;

end.
