unit pipe_calculator;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Menus, Vcl.Imaging.pngimage,
  Vcl.ExtCtrls, Vcl.Grids, Vcl.StdCtrls;

type
  TFcalculator3i = class(TForm)
    MainMenu1: TMainMenu;
    N1: TMenuItem;
    N2: TMenuItem;
    N3: TMenuItem;
    Panel1: TPanel;
    StringGrid1: TStringGrid;
    Panel2: TPanel;
    Image1: TImage;
    Image2: TImage;
    Panel3: TPanel;
    StringGrid2: TStringGrid;
    Image3: TImage;
    Image4: TImage;
    Image5: TImage;
    Image6: TImage;
    N4: TMenuItem;
    EGridRow: TEdit;
    Edit1: TEdit;
    Button1: TButton;
    Edit2: TEdit;
    procedure FormCreate(Sender: TObject);
    procedure Image1Click(Sender: TObject);
    procedure Image2Click(Sender: TObject);
    procedure StringGrid1DrawCell(Sender: TObject; ACol, ARow: Integer;
      Rect: TRect; State: TGridDrawState);
    procedure Image3Click(Sender: TObject);
    procedure Image4Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    procedure Сheckingvalue ;
  end;

var
  Fcalculator3i: TFcalculator3i;

implementation

{$R *.dfm}

procedure TFcalculator3i.Button1Click(Sender: TObject);
begin
  Сheckingvalue;
end;

procedure TFcalculator3i.FormCreate(Sender: TObject);
begin
  StringGrid1.ColWidths[0] := 40;
  StringGrid1.ColWidths[1] := 170;
  StringGrid1.ColWidths[2] := 70;
  StringGrid1.ColWidths[3] := 70;
  StringGrid1.ColWidths[4] := 70;
  StringGrid1.ColWidths[5] := 70;
  StringGrid1.ColWidths[6] := 70;
  StringGrid1.ColWidths[7] := 80;
  StringGrid1.ColWidths[8] := 80;
  StringGrid1.ColWidths[9] := 80;
  StringGrid1.ColWidths[10] := 90;
  StringGrid1.ColWidths[11] := 90;
  StringGrid1.ColWidths[12] := 100;
  StringGrid1.ColWidths[13] := 100;
  StringGrid1.ColWidths[14] := 100;

  StringGrid2.ColWidths[0] := 100;
  StringGrid2.ColWidths[1] := 100;
  StringGrid2.ColWidths[2] := 100;

  StringGrid1.Cells[0,0]:='№';
  StringGrid1.Cells[1,0]:='Наименование';
  StringGrid1.Cells[2,0]:='D н';
  StringGrid1.Cells[3,0]:='D вн';
  StringGrid1.Cells[4,0]:='D max';
  StringGrid1.Cells[5,0]:='D мн';
  StringGrid1.Cells[6,0]:='D мв';
  StringGrid1.Cells[7,0]:='Резьба';
  StringGrid1.Cells[8,0]:='Масса i,кг';
  StringGrid1.Cells[9,0]:='Масса м,кг';
  StringGrid1.Cells[10,0]:='Длина, м';
  StringGrid1.Cells[11,0]:='Длина свечи, м';
  StringGrid1.Cells[12,0]:='Масса, кг';
  StringGrid1.Cells[13,0]:='Масса, т';
  StringGrid1.Cells[14,0]:='Вес, кН';
end;

procedure TFcalculator3i.Image1Click(Sender: TObject);
begin
 Panel1.Height:=22;
 Image1.Visible:=False;
 Image2.Visible:=True;
end;

procedure TFcalculator3i.Image2Click(Sender: TObject);
begin
 Panel1.Height:=131;
 Image2.Visible:=False;
 Image1.Visible:=True;
end;

procedure TFcalculator3i.Image3Click(Sender: TObject);
begin
   EGridRow.Text:=IntToStr(StrToInt(EGridRow.Text)+1);
   StringGrid1.RowCount:=StrToInt(EGridRow.Text);
end;

procedure TFcalculator3i.Image4Click(Sender: TObject);
begin
  if StrToInt(EGridRow.Text)>1 then
   begin
    EGridRow.Text:=IntToStr(StrToInt(EGridRow.Text)-1);
    StringGrid1.RowCount:=StrToInt(EGridRow.Text);
   end;
end;

procedure TFcalculator3i.StringGrid1DrawCell(Sender: TObject; ACol,
  ARow: Integer; Rect: TRect; State: TGridDrawState);
    const //здесь определяем Ваш цвет. Так же можно использовать цвета по умолчанию.
  clBlue11 = TColor($00F2BB60);
  clRed2 = TColor($00A6B0F9);
  clYellow = TColor($0080F7F3);
begin
   if ((ACol = 12) or (ACol = 13) or (ACol = 14)) and (ARow>0)  then
    begin
    StringGrid1.Canvas.Brush.Color := clBlue11;
    //StringGrid3.Canvas.Font.Color := clWhite;
    stringGrid1.Canvas.FillRect(rect);
    stringGrid1.Canvas.TextRect(Rect, Rect.Left, Rect.Top, stringGrid1.Cells[ACol, ARow]);
    end;

    if ((ACol = 10) or (ACol = 11))  and (ARow>0)  then
    begin
    StringGrid1.Canvas.Brush.Color := clRed2;
    //StringGrid3.Canvas.Font.Color := clWhite;
    stringGrid1.Canvas.FillRect(rect);
    stringGrid1.Canvas.TextRect(Rect, Rect.Left, Rect.Top, stringGrid1.Cells[ACol, ARow]);
    end;

     if (ACol = 9) and (ARow>0)  then
    begin
    StringGrid1.Canvas.Brush.Color := clYellow;
    //StringGrid3.Canvas.Font.Color := clWhite;
    stringGrid1.Canvas.FillRect(rect);
    stringGrid1.Canvas.TextRect(Rect, Rect.Left, Rect.Top, stringGrid1.Cells[ACol, ARow]);
    end;

end;

procedure TFcalculator3i.Сheckingvalue;
   var n: String ;
       i : Integer;
begin
  n:=Edit1.Text;
  for i := 1 to length(Edit1.Text) do
  begin
    if not (n[i] in ['1'..'9',',','.']) then
    begin
      ShowMessage('строка');
      Exit
    end;
  end;


end;

end.
